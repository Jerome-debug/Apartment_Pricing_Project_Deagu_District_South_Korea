---
title: "Group3_Project"
author: "Bundi Kirimi"
date: "2/7/2022"
output: html_document
---
#Loading the libraries
````{r}
#specify the path where the file is located
library("data.table")
library(tidyverse)
library(magrittr)
library(warn = -1)
library("ggbiplot")
library(ggplot2)
library(lattice)
library(corrplot)
library(DataExplorer)
library(pastecs)
library(psych)
library(factoextra)
library(caret)

````



```{r}
#Loading the data
path <-"C:/Users/Jerome/Downloads/Daegu_Real_Estate_data.csv" 

df<-read.csv(path, sep = ",")

head(df)
```


#Previewing the summary of the dataset
```{r}
summary(df)
```

#Checking the data
```{r}
#Length
length(df)
```
The dataframe has 16 columns


````{r}
#Dimensions
dim(df)

````




#The dataframe has 12330 row entries and 18 columns
Column Names
```{r}
colnames(df)

```

Column data types

```{r}
sapply(df, class)
```




#Data Cleaning

```{r}

any(is.na(df))
```

```{r}
#Duplicates
duplicated_rows <- df[duplicated(df),]

dim(duplicated_rows)

```
Removing duplicates
```{r}
df1 <- df[-which(duplicated(df)), ]
dim(df1)
```

#Data Types
```{r}

sapply(df1, class)
```

```{r}
summary(df1)
```

median is 212,389..This will be the nedium priced house
32,743 will be the least price
585,840 the most expensive house

#Univariate Analysis

```{r}
unique(df1$HallwayType)

factor(unique(df1$HallwayType))

```


```{r}
unique(df1$HeatingType)

factor(unique(df1$HeatingType))
```

```{r}
unique(df1$AptManageType)

factor(unique(df1$AptManageType))
```



```{r}
#Visualizing the Hallway types

library(ggplot2)
ggplot(df1, aes(HallwayType)) + 
   geom_bar(fill = "red")
```

We can see most apartments had terraced Hallway types.

```{r}
#Visualizing the Apartment Management types

library(ggplot2)
ggplot(df1, aes(AptManageType)) + 
   geom_bar(fill = "Pink")
```

Most Apartments had some sort of Management while very few had self management


```{r}
#Visualizing the heating systems

library(ggplot2)
ggplot(df1, aes(HeatingType)) + 
   geom_bar(fill = "Blue")
```
Most Apartments had Individual Heating System

```{r}
#
#each of the values printed below appear thrice in the dataset
#distribution
hist(df1$SalePrice , col=c("darkorange"))


```
```{r}
#HallwayTypecorridor                   HallwayTypemixed                HallwayTypeterraced
#each of the values printed below appear thrice in the dataset
#distribution
hist(df1$Age , col=c("darkorange"))
````

```{r}
#HallwayTypecorridor                   HallwayTypemixed                HallwayTypeterraced
#each of the values printed below appear thrice in the dataset
#distribution
hist(df1$YrSold , col=c("darkorange"))

```
```{r}
#Histogram of size in squarefoot
hist(df1$Size.sqf. , col=c("darkorange"))
```

```{r}
#Histogram of floor column
#distribution
hist(df1$Floor , col=c("darkorange"))
```

```{r}
summary(df1)
```



```{r}
head(df1)
```

```{r}
df1$Age <- df1$YrSold - df1$YearBuilt
df1

```


```{r}


data <- df1[ c(1,5,6,7,8,9,10,11,14,15,16,18,19,20,21,22,23,28,29,30,31) ]

head(data)
```

Bivariate Analysis

```{r}

```



```{r}
head(df1)
```
Sale Price Vs Size in Square foot of the house
```{r}
#Sale Price Vs Size in Square foot of the house
ggplot(df1, aes(x = Floor, y = SalePrice)) +
  geom_point() +
  stat_smooth(method = 'lm')
```


```{r}
ggplot(df1, aes(x = AptManageType, y = SalePrice)) +
  geom_boxplot() 
```


```{r}
# Assign plot to a variable
surveys_plot <- ggplot(data = df1,
                       mapping = aes(x = SalePrice, y = Floor))

# Draw the plot
surveys_plot +
    geom_point()

```

```{r}
# Assign plot to a variable
surveys_plot <- ggplot(data = df1,
                       mapping = aes(x = Size.sqf., y = SalePrice))

# Draw the plot
surveys_plot +
    geom_point()

````

```{r}
#create scatterplot of hours studied vs. exam score
plot(df1$N_elevators, df1$N_Parkinglot.Basement.
, pch=16, col='steelblue',
     main='Elevator Parkinglot basement',
     xlab='Elevator', ylab='Basement ')
```







facto
Performing one hot encoding

```{r}
# One hot encoding of the factor variables.
library(caret)
## Loading required package: lattice
dmy <- dummyVars(" ~ .", data = df1)
dummy_df <- data.frame(predict(dmy, newdata = df1))

#print(dummy_df)
head(dummy_df)

```

Checking the datatypes

```{r}
sapply(dummy_df, class)

```








Regression
```{r}
set.seed(123)
sample <- sample(c(TRUE, FALSE), nrow(dummy_df), replace = T, prob = c(0.6,0.4))
train <- advertising[sample, ]
test <- advertising[!sample, ]
```



